const r=async(e="",s={},t="GET")=>{const o="https://www.colorcoms.com/api";t=t.toUpperCase(),e=o+e;let n=await chrome.storage.sync.get("user_data").then(a=>a.user_data?a.user_data.token:""),i={method:t,headers:{"Content-Type":"application/json",authorization:`Bearer ${n}`}};if(t=="GET"){let a="";Object.keys(s).forEach(d=>{a+=d+"="+s[d]+"&"}),a!==""&&(a=a.substr(0,a.lastIndexOf("&")),e=e+"?"+a)}else t=="POST1"?i={method:"POST",headers:{authorization:`Bearer ${n}`},body:s}:Object.defineProperty(i,"body",{value:JSON.stringify(s)});const p=await fetch(e,i);return p.ok?await p.json():p.status},c=async(e="",s={},t="GET")=>{const o="https://www.myshopibar.com/whatsapp";t=t.toUpperCase(),e=o+e;let n={method:t,headers:{"Content-Type":"application/json"}};if(t=="GET"){let a="";Object.keys(s).forEach(d=>{a+=d+"="+s[d]+"&"}),a!==""&&(a=a.substr(0,a.lastIndexOf("&")),e=e+"?"+a)}else t=="POST1"?n={method:"POST",body:s}:Object.defineProperty(n,"body",{value:JSON.stringify(s)});const p=await fetch(e,n);return p.ok?await p.json():p.status},l={getSetting:()=>c("/setting",{},"get"),getOrderList:e=>c("/order",e,"get"),addInvoice:e=>c("/addinvoice",e,"post"),getInvoiceList:e=>c("/invoice",e,"get"),editInvoice:e=>c("/patchinvoice",e,"patch"),delInvoice:e=>c("/delinvoice",e,"delete"),hasAddAuth:()=>c("/authlist",{},"get"),getEntriesList:()=>c("/getaddentry",{},"get"),getProductList:e=>c("/productslist",e,"get"),getCountryList:e=>c("/countrys",e,"get"),getCustomerList:e=>c("/customer",e,"get"),getCarrierList:e=>c("/carrier",e,"get"),addShip:e=>c("/ship",e,"post"),updateShip:e=>c("/updateship",e,"post"),uploadImg:e=>c("/upload",e,"post1")};chrome.runtime.onMessage.addListener(function(e,s,t){if(e.type=="doFetch"){if(e.params.fn==="uploadImg"){let o=new FormData;e.params.params.fileList.forEach(n=>{o.append("file",u(n.detail,n.name))}),e.params.params=o}return m(e.params,t),!0}else if(e.type=="openShortCuts")w();else{if(e.type=="uploadOss")return f(e,t),!0;e.type=="closeWindow"&&chrome.tabs.query({active:!0,currentWindow:!0},o=>{chrome.tabs.remove(o[0].id,()=>{chrome.tabs.query({url:"https://web.whatsapp.com/"},function(n){n.length?chrome.tabs.update(n[0].id,{active:!0},()=>{e.callback=="contact"&&chrome.tabs.sendMessage(n[0].id,{info:"chat",phone:"8618321625159"})}):chrome.tabs.create({url:"https://web.whatsapp.com/"})})})})}});function u(e,s){for(var t=e.split(","),o=t[0].match(/:(.*?);/)[1],n=atob(t[1]),i=n.length,p=new Uint8Array(i);i--;)p[i]=n.charCodeAt(i);return new File([p],s,{type:o})}function m(e,s){return l[e.fn](e.params).then(t=>{s(typeof t=="number"?{success:!1}:t),typeof t=="number"&&chrome.tabs.query({url:"https://web.whatsapp.com/"},function(o){chrome.tabs.sendMessage(o[0].id,{type:"error",code:t})})})}function g(){location.reload()}function f(e,s){let t=e.file,o=e.ossInfo;if(!o)return;const n=new FormData;return n.append("name",t.filename),n.append("policy",o.policy),n.append("OSSAccessKeyId",o.ossAccessKeyId),n.append("success_action_status","200"),n.append("signature",o.signature),n.append("key",o.dir+t.filename),n.append("file",u(t.detail,t.filename)),fetch(o==null?void 0:o.host,{method:"POST",body:n}).then(i=>{s({success:i.ok,file_link:`${o.host}/${o.dir}${t.filename}`})})}chrome.action.onClicked.addListener(function(){chrome.tabs.query({url:"https://web.whatsapp.com/"},function(e){e.length?(chrome.tabs.update(e[0].id,{active:!0}),chrome.tabs.sendMessage(e[0].id,{info:"connect"},s=>{s||chrome.scripting.executeScript({target:{tabId:e[0].id},func:g})})):chrome.tabs.create({url:"https://web.whatsapp.com/"})})});function y(){let e=document.getElementById("pane-side");e.scrollTop=999999}function b(){let e=document.getElementById("pane-side");e.scrollTop=0}chrome.commands.onCommand.addListener(async e=>{let[s]=await chrome.tabs.query({active:!0,currentWindow:!0});if(!await chrome.storage.sync.get("privacy_params").then(o=>o.privacy_params&&o.privacy_params.scrollStatus))return;e=="scroll_down"&&chrome.scripting.executeScript({target:{tabId:s.id},func:y}),e=="scroll_up"&&chrome.scripting.executeScript({target:{tabId:s.id},func:b})});const w=()=>{chrome.tabs.create({url:"chrome://extensions/shortcuts"})};

// 已移除所有与登录、支付、授权、付费相关的API和逻辑，仅保留基础功能